
<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="http://localhost:8000/theme/stylesheet/style.min.css">


    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
          href="http://localhost:8000/theme/pygments/github.min.css">


  <link rel="stylesheet" type="text/css" href="http://localhost:8000/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="http://localhost:8000/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="http://localhost:8000/theme/font-awesome/css/solid.css">





  


 

<meta name="author" content="Daniel Dai" />
<meta name="description" content="1. AsciiJSON 使用 AsciiJSON 生成纯 ASCII JSON, 非 ASCII 字符会被转义。 func main() { r := gin.Default() r.GET(&#34;/someJSON&#34;, func(c *gin.Context) { data := map[string]interface{}{ &#34;lang&#34;: &#34;GO语言&#34;, &#34;tag&#34;: &#34;&lt;br&#34;, } // 将会输出 : {&#34;lang&#34;:&#34;GO\u8bed\u8a00&#34;,&#34;tag&#34;:&#34;\u003cbr&#34;} c.AsciiJSON …" />
<meta name="keywords" content="Golang, Go">


  <meta property="og:site_name" content="Daniel Dai的网络日志"/>
  <meta property="og:title" content="Gin API 示例 【进行中】"/>
  <meta property="og:description" content="1. AsciiJSON 使用 AsciiJSON 生成纯 ASCII JSON, 非 ASCII 字符会被转义。 func main() { r := gin.Default() r.GET(&#34;/someJSON&#34;, func(c *gin.Context) { data := map[string]interface{}{ &#34;lang&#34;: &#34;GO语言&#34;, &#34;tag&#34;: &#34;&lt;br&#34;, } // 将会输出 : {&#34;lang&#34;:&#34;GO\u8bed\u8a00&#34;,&#34;tag&#34;:&#34;\u003cbr&#34;} c.AsciiJSON …"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="http://localhost:8000/gin-api-examples.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2021-09-14 22:20:00+08:00"/>
  <meta property="article:modified_time" content=""/>
  <meta property="article:author" content="http://localhost:8000/author/daniel-dai.html">
  <meta property="article:section" content="Post"/>
  <meta property="article:tag" content="Golang"/>
  <meta property="article:tag" content="Go"/>
  <meta property="og:image" content="http://localhost:8000/daniel_150.jpeg">

  <title>Daniel Dai的网络日志 &ndash; Gin API 示例 【进行中】</title>


  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0025679579683360"
          crossorigin="anonymous"></script>
</head>
<body class="light-theme">
  <aside>
    <div>
      <a href="http://localhost:8000/">
        <img src="http://localhost:8000/daniel_150.jpeg" alt="Daniel Dai" title="Daniel Dai">
      </a>

      <h3>
        <a href="http://localhost:8000/">Daniel Dai</a>
      </h3>

<p>互联网产品和技术</p>

      <nav>
        <ul class="list">


              <li>
                <a target="_self"
                   href="http://localhost:8000/pages/about-me.html#about-me">
                  关于我
                </a>
              </li>

        </ul>
      </nav>

      <ul class="social">
          <li>
            <a  class="sc-github" href="https://github.com/danieldai" target="_blank">
              <i class="fab fa-github"></i>
            </a>
          </li>
          <li>
            <a  class="sc-linkedin" href="https://www.linkedin.com/in/daniel-dai" target="_blank">
              <i class="fab fa-linkedin"></i>
            </a>
          </li>
          <li>
            <a  class="sc-twitter" href="https://twitter.com/danieldai_com" target="_blank">
              <i class="fab fa-twitter"></i>
            </a>
          </li>
      </ul>
    </div>

  </aside>
  <main>

    <nav>
      <a href="http://localhost:8000/">首页</a>

      <a href="/archives.html">存档</a>
      <a href="/categories.html">分类</a>
      <a href="/tags.html">标签</a>



      <a href="https://kalacloud.com" target="__blank">卡拉云后台系统</a>
    </nav>

<article class="single">
  <header>
      
    <h1 id="gin-api-examples">Gin API 示例 【进行中】</h1>
    <p>
      发布时间: 2021年09月14日, 分类: <a href="http://localhost:8000/category/post.html">Post</a>

    </p>
  </header>


  <div>
    <h2>1. AsciiJSON</h2>
<p>使用 AsciiJSON 生成纯 ASCII JSON, 非 ASCII 字符会被转义。</p>
<div class="highlight"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">r</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">gin</span><span class="p">.</span><span class="nx">Default</span><span class="p">()</span>

<span class="w">    </span><span class="nx">r</span><span class="p">.</span><span class="nx">GET</span><span class="p">(</span><span class="s">&quot;/someJSON&quot;</span><span class="p">,</span><span class="w"> </span><span class="kd">func</span><span class="p">(</span><span class="nx">c</span><span class="w"> </span><span class="o">*</span><span class="nx">gin</span><span class="p">.</span><span class="nx">Context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">data</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{}{</span>
<span class="w">            </span><span class="s">&quot;lang&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GO语言&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s">&quot;tag&quot;</span><span class="p">:</span><span class="w">  </span><span class="s">&quot;&lt;br&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="c1">// 将会输出 : {&quot;lang&quot;:&quot;GO\u8bed\u8a00&quot;,&quot;tag&quot;:&quot;\u003cbr&quot;}</span>
<span class="w">        </span><span class="nx">c</span><span class="p">.</span><span class="nx">AsciiJSON</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">StatusOK</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">)</span>
<span class="w">    </span><span class="p">})</span>

<span class="w">    </span><span class="c1">// 在 0.0.0.0:8080 上监听</span>
<span class="w">    </span><span class="nx">r</span><span class="p">.</span><span class="nx">Run</span><span class="p">(</span><span class="s">&quot;:8080&quot;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

<p>测试：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>curl<span class="w"> </span>http://localhost:8080/someJSON

<span class="o">{</span><span class="s2">&quot;lang&quot;</span>:<span class="s2">&quot;GO\u8bed\u8a00&quot;</span>,<span class="s2">&quot;tag&quot;</span>:<span class="s2">&quot;\u003cbr&quot;</span><span class="o">}</span>
</code></pre></div>

<p>注意，如果使用chrome浏览器访问这个地址，浏览器中会显示，这是浏览器自动进行了处理：</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="err">la</span><span class="kc">n</span><span class="err">g</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;GO语言&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="kc">ta</span><span class="err">g</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;br&quot;</span>
<span class="p">}</span>
</code></pre></div>

<h2>2. 绑定表单请求数据到自定义的 struct</h2>
<p>下列示例使用了自定义的<code>struct</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kd">type</span><span class="w"> </span><span class="nx">StructA</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">FieldA</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="s">`form:&quot;field_a&quot;`</span>
<span class="p">}</span>

<span class="kd">type</span><span class="w"> </span><span class="nx">StructB</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">NestedStruct</span><span class="w"> </span><span class="nx">StructA</span>
<span class="w">    </span><span class="nx">FieldB</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="s">`form:&quot;field_b&quot;`</span>
<span class="p">}</span>

<span class="kd">type</span><span class="w"> </span><span class="nx">StructC</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">NestedStructPointer</span><span class="w"> </span><span class="o">*</span><span class="nx">StructA</span>
<span class="w">    </span><span class="nx">FieldC</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="s">`form:&quot;field_c&quot;`</span>
<span class="p">}</span>

<span class="kd">type</span><span class="w"> </span><span class="nx">StructD</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">NestedAnonyStruct</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">FieldX</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="s">`form:&quot;field_x&quot;`</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">FieldD</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="s">`form:&quot;field_d&quot;`</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">GetDataB</span><span class="p">(</span><span class="nx">c</span><span class="w"> </span><span class="o">*</span><span class="nx">gin</span><span class="p">.</span><span class="nx">Context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="nx">StructB</span>
<span class="w">    </span><span class="nx">c</span><span class="p">.</span><span class="nx">Bind</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">b</span><span class="p">)</span>
<span class="w">    </span><span class="nx">c</span><span class="p">.</span><span class="nx">JSON</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="w"> </span><span class="nx">gin</span><span class="p">.</span><span class="nx">H</span><span class="p">{</span>
<span class="w">        </span><span class="s">&quot;a&quot;</span><span class="p">:</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">NestedStruct</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;b&quot;</span><span class="p">:</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">FieldB</span><span class="p">,</span>
<span class="w">    </span><span class="p">})</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">GetDataC</span><span class="p">(</span><span class="nx">c</span><span class="w"> </span><span class="o">*</span><span class="nx">gin</span><span class="p">.</span><span class="nx">Context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="nx">StructC</span>
<span class="w">    </span><span class="nx">c</span><span class="p">.</span><span class="nx">Bind</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">b</span><span class="p">)</span>
<span class="w">    </span><span class="nx">c</span><span class="p">.</span><span class="nx">JSON</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="w"> </span><span class="nx">gin</span><span class="p">.</span><span class="nx">H</span><span class="p">{</span>
<span class="w">        </span><span class="s">&quot;a&quot;</span><span class="p">:</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">NestedStructPointer</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;c&quot;</span><span class="p">:</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">FieldC</span><span class="p">,</span>
<span class="w">    </span><span class="p">})</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">GetDataD</span><span class="p">(</span><span class="nx">c</span><span class="w"> </span><span class="o">*</span><span class="nx">gin</span><span class="p">.</span><span class="nx">Context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="nx">StructD</span>
<span class="w">    </span><span class="nx">c</span><span class="p">.</span><span class="nx">Bind</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">b</span><span class="p">)</span>
<span class="w">    </span><span class="nx">c</span><span class="p">.</span><span class="nx">JSON</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="w"> </span><span class="nx">gin</span><span class="p">.</span><span class="nx">H</span><span class="p">{</span>
<span class="w">        </span><span class="s">&quot;x&quot;</span><span class="p">:</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">NestedAnonyStruct</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;d&quot;</span><span class="p">:</span><span class="w"> </span><span class="nx">b</span><span class="p">.</span><span class="nx">FieldD</span><span class="p">,</span>
<span class="w">    </span><span class="p">})</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">r</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">gin</span><span class="p">.</span><span class="nx">Default</span><span class="p">()</span>
<span class="w">    </span><span class="nx">r</span><span class="p">.</span><span class="nx">GET</span><span class="p">(</span><span class="s">&quot;/getb&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">GetDataB</span><span class="p">)</span>
<span class="w">    </span><span class="nx">r</span><span class="p">.</span><span class="nx">GET</span><span class="p">(</span><span class="s">&quot;/getc&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">GetDataC</span><span class="p">)</span>
<span class="w">    </span><span class="nx">r</span><span class="p">.</span><span class="nx">GET</span><span class="p">(</span><span class="s">&quot;/getd&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">GetDataD</span><span class="p">)</span>

<span class="w">    </span><span class="nx">r</span><span class="p">.</span><span class="nx">POST</span><span class="p">(</span><span class="s">&quot;/getb&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">GetDataB</span><span class="p">)</span>
<span class="w">    </span><span class="nx">r</span><span class="p">.</span><span class="nx">POST</span><span class="p">(</span><span class="s">&quot;/getc&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">GetDataC</span><span class="p">)</span>
<span class="w">    </span><span class="nx">r</span><span class="p">.</span><span class="nx">POST</span><span class="p">(</span><span class="s">&quot;/getd&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">GetDataD</span><span class="p">)</span>

<span class="w">    </span><span class="nx">r</span><span class="p">.</span><span class="nx">Run</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div>

<p>使用 <code>curl</code> 命令测试：</p>
<div class="highlight"><pre><span></span><code><span class="c1"># 下面3个命令使用query string 传递数据</span>
$<span class="w"> </span>curl<span class="w"> </span><span class="s2">&quot;http://localhost:8080/getb?field_a=hello&amp;field_b=world&quot;</span>
<span class="o">{</span><span class="s2">&quot;a&quot;</span>:<span class="o">{</span><span class="s2">&quot;FieldA&quot;</span>:<span class="s2">&quot;hello&quot;</span><span class="o">}</span>,<span class="s2">&quot;b&quot;</span>:<span class="s2">&quot;world&quot;</span><span class="o">}</span>

$<span class="w"> </span>curl<span class="w"> </span><span class="s2">&quot;http://localhost:8080/getc?field_a=hello&amp;field_c=world&quot;</span>
<span class="o">{</span><span class="s2">&quot;a&quot;</span>:<span class="o">{</span><span class="s2">&quot;FieldA&quot;</span>:<span class="s2">&quot;hello&quot;</span><span class="o">}</span>,<span class="s2">&quot;c&quot;</span>:<span class="s2">&quot;world&quot;</span><span class="o">}</span>

$<span class="w"> </span>curl<span class="w"> </span><span class="s2">&quot;http://localhost:8080/getd?field_x=hello&amp;field_d=world&quot;</span>
<span class="o">{</span><span class="s2">&quot;d&quot;</span>:<span class="s2">&quot;world&quot;</span>,<span class="s2">&quot;x&quot;</span>:<span class="o">{</span><span class="s2">&quot;FieldX&quot;</span>:<span class="s2">&quot;hello&quot;</span><span class="o">}}</span>

<span class="c1"># 下面3个命令使用表单传递数据</span>
$<span class="w"> </span>curl<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;field_a=hello&amp;field_b=world&quot;</span><span class="w"> </span><span class="s2">&quot;http://localhost:8080/getb&quot;</span>
<span class="o">{</span><span class="s2">&quot;a&quot;</span>:<span class="o">{</span><span class="s2">&quot;FieldA&quot;</span>:<span class="s2">&quot;hello&quot;</span><span class="o">}</span>,<span class="s2">&quot;b&quot;</span>:<span class="s2">&quot;world&quot;</span><span class="o">}</span>

$<span class="w"> </span>curl<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;field_a=hello&amp;field_c=world&quot;</span><span class="w"> </span><span class="s2">&quot;http://localhost:8080/getc&quot;</span>
<span class="o">{</span><span class="s2">&quot;a&quot;</span>:<span class="o">{</span><span class="s2">&quot;FieldA&quot;</span>:<span class="s2">&quot;hello&quot;</span><span class="o">}</span>,<span class="s2">&quot;c&quot;</span>:<span class="s2">&quot;world&quot;</span><span class="o">}</span>

$<span class="w"> </span>curl<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;field_x=hello&amp;field_d=world&quot;</span><span class="w"> </span><span class="s2">&quot;http://localhost:8080/getd&quot;</span>
<span class="o">{</span><span class="s2">&quot;d&quot;</span>:<span class="s2">&quot;world&quot;</span>,<span class="s2">&quot;x&quot;</span>:<span class="o">{</span><span class="s2">&quot;FieldX&quot;</span>:<span class="s2">&quot;hello&quot;</span><span class="o">}}</span>
</code></pre></div>

<p>从测试可以看出，上面的方法不但可以绑定来自<code>query string</code>的数据，还可以绑定来自表单的数据</p>
<h2>3. Bind html checkboxes</h2>
<p>main.go</p>
<div class="highlight"><pre><span></span><code><span class="o">...</span>

<span class="kd">type</span><span class="w"> </span><span class="nx">myForm</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Colors</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="w"> </span><span class="s">`form:&quot;colors[]&quot;`</span>
<span class="p">}</span>

<span class="o">...</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">formHandler</span><span class="p">(</span><span class="nx">c</span><span class="w"> </span><span class="o">*</span><span class="nx">gin</span><span class="p">.</span><span class="nx">Context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">fakeForm</span><span class="w"> </span><span class="nx">myForm</span>
<span class="w">    </span><span class="nx">c</span><span class="p">.</span><span class="nx">ShouldBind</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">fakeForm</span><span class="p">)</span>
<span class="w">    </span><span class="nx">c</span><span class="p">.</span><span class="nx">JSON</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="w"> </span><span class="nx">gin</span><span class="p">.</span><span class="nx">H</span><span class="p">{</span><span class="s">&quot;color&quot;</span><span class="p">:</span><span class="w"> </span><span class="nx">fakeForm</span><span class="p">.</span><span class="nx">Colors</span><span class="p">})</span>
<span class="p">}</span>

<span class="o">...</span>
</code></pre></div>

<p>form.html</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;/&quot;</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;POST&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Check some colors<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">&gt;</span>Red<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;checkbox&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;colors[]&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;red&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;green&quot;</span><span class="p">&gt;</span>Green<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;checkbox&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;colors[]&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;green&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;green&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">&gt;</span>Blue<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;checkbox&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;colors[]&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;blue&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</code></pre></div>

<p>result:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="s2">&quot;color&quot;</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="s2">&quot;green&quot;</span><span class="p">,</span><span class="s2">&quot;blue&quot;</span><span class="p">]}</span>
</code></pre></div>

<h2>Bind query string or post data</h2>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">main</span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;log&quot;</span>
<span class="w">    </span><span class="s">&quot;time&quot;</span>

<span class="w">    </span><span class="s">&quot;github.com/gin-gonic/gin&quot;</span>
<span class="p">)</span>

<span class="kd">type</span><span class="w"> </span><span class="nx">Person</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Name</span><span class="w">     </span><span class="kt">string</span><span class="w">    </span><span class="s">`form:&quot;name&quot;`</span>
<span class="w">    </span><span class="nx">Address</span><span class="w">  </span><span class="kt">string</span><span class="w">    </span><span class="s">`form:&quot;address&quot;`</span>
<span class="w">    </span><span class="nx">Birthday</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Time</span><span class="w"> </span><span class="s">`form:&quot;birthday&quot; time_format:&quot;2006-01-02&quot; time_utc:&quot;1&quot;`</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">route</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">gin</span><span class="p">.</span><span class="nx">Default</span><span class="p">()</span>
<span class="w">    </span><span class="nx">route</span><span class="p">.</span><span class="nx">GET</span><span class="p">(</span><span class="s">&quot;/testing&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">startPage</span><span class="p">)</span>
<span class="w">    </span><span class="nx">route</span><span class="p">.</span><span class="nx">Run</span><span class="p">(</span><span class="s">&quot;:8085&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">startPage</span><span class="p">(</span><span class="nx">c</span><span class="w"> </span><span class="o">*</span><span class="nx">gin</span><span class="p">.</span><span class="nx">Context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">person</span><span class="w"> </span><span class="nx">Person</span>
<span class="w">    </span><span class="c1">// If `GET`, only `Form` binding engine (`query`) used.</span>
<span class="w">    </span><span class="c1">// If `POST`, first checks the `content-type` for `JSON` or `XML`, then uses `Form` (`form-data`).</span>
<span class="w">    </span><span class="c1">// See more at https://github.com/gin-gonic/gin/blob/master/binding/binding.go#L48</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">c</span><span class="p">.</span><span class="nx">ShouldBind</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">person</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">log</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">person</span><span class="p">.</span><span class="nx">Name</span><span class="p">)</span>
<span class="w">        </span><span class="nx">log</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">person</span><span class="p">.</span><span class="nx">Address</span><span class="p">)</span>
<span class="w">        </span><span class="nx">log</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">person</span><span class="p">.</span><span class="nx">Birthday</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">c</span><span class="p">.</span><span class="nx">String</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Success&quot;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

<p>Test it with:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>curl<span class="w"> </span>-X<span class="w"> </span>GET<span class="w"> </span><span class="s2">&quot;localhost:8085/testing?name=appleboy&amp;address=xyz&amp;birthday=1992-03-15&quot;</span>
</code></pre></div>

<h2>Bind Uri</h2>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">main</span>

<span class="kn">import</span><span class="w"> </span><span class="s">&quot;github.com/gin-gonic/gin&quot;</span>

<span class="kd">type</span><span class="w"> </span><span class="nx">Person</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">ID</span><span class="w">   </span><span class="kt">string</span><span class="w"> </span><span class="s">`uri:&quot;id&quot; binding:&quot;required,uuid&quot;`</span>
<span class="w">    </span><span class="nx">Name</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="s">`uri:&quot;name&quot; binding:&quot;required&quot;`</span>
<span class="p">}</span>

<span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">route</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">gin</span><span class="p">.</span><span class="nx">Default</span><span class="p">()</span>
<span class="w">    </span><span class="nx">route</span><span class="p">.</span><span class="nx">GET</span><span class="p">(</span><span class="s">&quot;/:name/:id&quot;</span><span class="p">,</span><span class="w"> </span><span class="kd">func</span><span class="p">(</span><span class="nx">c</span><span class="w"> </span><span class="o">*</span><span class="nx">gin</span><span class="p">.</span><span class="nx">Context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">person</span><span class="w"> </span><span class="nx">Person</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">c</span><span class="p">.</span><span class="nx">ShouldBindUri</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">person</span><span class="p">);</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">c</span><span class="p">.</span><span class="nx">JSON</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span><span class="w"> </span><span class="nx">gin</span><span class="p">.</span><span class="nx">H</span><span class="p">{</span><span class="s">&quot;msg&quot;</span><span class="p">:</span><span class="w"> </span><span class="nx">err</span><span class="p">})</span>
<span class="w">            </span><span class="k">return</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nx">c</span><span class="p">.</span><span class="nx">JSON</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="w"> </span><span class="nx">gin</span><span class="p">.</span><span class="nx">H</span><span class="p">{</span><span class="s">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="nx">person</span><span class="p">.</span><span class="nx">Name</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;uuid&quot;</span><span class="p">:</span><span class="w"> </span><span class="nx">person</span><span class="p">.</span><span class="nx">ID</span><span class="p">})</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span><span class="nx">route</span><span class="p">.</span><span class="nx">Run</span><span class="p">(</span><span class="s">&quot;:8088&quot;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

<p>Test it with:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>curl<span class="w"> </span>-v<span class="w"> </span>localhost:8088/thinkerou/987fbc97-4bed-5078-9f07-9141ba07c9f3
$<span class="w"> </span>curl<span class="w"> </span>-v<span class="w"> </span>localhost:8088/thinkerou/not-uuid
</code></pre></div>

<h2>Build a single binary with templates</h2>
<h3>Use the third-party package</h3>
<p>You can use the third party package to build a server into a single binary containing templates by using go-assets.</p>
<div class="highlight"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">r</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">gin</span><span class="p">.</span><span class="nx">New</span><span class="p">()</span>

<span class="w">    </span><span class="nx">t</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">loadTemplate</span><span class="p">()</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nb">panic</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">r</span><span class="p">.</span><span class="nx">SetHTMLTemplate</span><span class="p">(</span><span class="nx">t</span><span class="p">)</span>

<span class="w">    </span><span class="nx">r</span><span class="p">.</span><span class="nx">GET</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">,</span><span class="w"> </span><span class="kd">func</span><span class="p">(</span><span class="nx">c</span><span class="w"> </span><span class="o">*</span><span class="nx">gin</span><span class="p">.</span><span class="nx">Context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">c</span><span class="p">.</span><span class="nx">HTML</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">StatusOK</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/html/index.tmpl&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span><span class="p">)</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span><span class="nx">r</span><span class="p">.</span><span class="nx">Run</span><span class="p">(</span><span class="s">&quot;:8080&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// loadTemplate loads templates embedded by go-assets-builder</span>
<span class="kd">func</span><span class="w"> </span><span class="nx">loadTemplate</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="nx">template</span><span class="p">.</span><span class="nx">Template</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">t</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">template</span><span class="p">.</span><span class="nx">New</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="nx">file</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="nx">Assets</span><span class="p">.</span><span class="nx">Files</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">file</span><span class="p">.</span><span class="nx">IsDir</span><span class="p">()</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">!</span><span class="nx">strings</span><span class="p">.</span><span class="nx">HasSuffix</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;.tmpl&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">continue</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nx">h</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">ioutil</span><span class="p">.</span><span class="nx">ReadAll</span><span class="p">(</span><span class="nx">file</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nx">t</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">t</span><span class="p">.</span><span class="nx">New</span><span class="p">(</span><span class="nx">name</span><span class="p">).</span><span class="nx">Parse</span><span class="p">(</span><span class="nb">string</span><span class="p">(</span><span class="nx">h</span><span class="p">))</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">t</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<span class="p">}</span>
</code></pre></div>

<p>See a complete example in the assets-in-binary/example01 directory.</p>
<h2>Using middleware</h2>
<div class="highlight"><pre><span></span><code><span class="kd">func</span><span class="w"> </span><span class="nx">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Creates a router without any middleware by default</span>
<span class="w">    </span><span class="nx">r</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">gin</span><span class="p">.</span><span class="nx">New</span><span class="p">()</span>

<span class="w">    </span><span class="c1">// Global middleware</span>
<span class="w">    </span><span class="c1">// Logger middleware will write the logs to gin.DefaultWriter even if you set with GIN_MODE=release.</span>
<span class="w">    </span><span class="c1">// By default gin.DefaultWriter = os.Stdout</span>
<span class="w">    </span><span class="nx">r</span><span class="p">.</span><span class="nx">Use</span><span class="p">(</span><span class="nx">gin</span><span class="p">.</span><span class="nx">Logger</span><span class="p">())</span>

<span class="w">    </span><span class="c1">// Recovery middleware recovers from any panics and writes a 500 if there was one.</span>
<span class="w">    </span><span class="nx">r</span><span class="p">.</span><span class="nx">Use</span><span class="p">(</span><span class="nx">gin</span><span class="p">.</span><span class="nx">Recovery</span><span class="p">())</span>

<span class="w">    </span><span class="c1">// Per route middleware, you can add as many as you desire.</span>
<span class="w">    </span><span class="nx">r</span><span class="p">.</span><span class="nx">GET</span><span class="p">(</span><span class="s">&quot;/benchmark&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">MyBenchLogger</span><span class="p">(),</span><span class="w"> </span><span class="nx">benchEndpoint</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// Authorization group</span>
<span class="w">    </span><span class="c1">// authorized := r.Group(&quot;/&quot;, AuthRequired())</span>
<span class="w">    </span><span class="c1">// exactly the same as:</span>
<span class="w">    </span><span class="nx">authorized</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">r</span><span class="p">.</span><span class="nx">Group</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="c1">// per group middleware! in this case we use the custom created</span>
<span class="w">    </span><span class="c1">// AuthRequired() middleware just in the &quot;authorized&quot; group.</span>
<span class="w">    </span><span class="nx">authorized</span><span class="p">.</span><span class="nx">Use</span><span class="p">(</span><span class="nx">AuthRequired</span><span class="p">())</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nx">authorized</span><span class="p">.</span><span class="nx">POST</span><span class="p">(</span><span class="s">&quot;/login&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">loginEndpoint</span><span class="p">)</span>
<span class="w">        </span><span class="nx">authorized</span><span class="p">.</span><span class="nx">POST</span><span class="p">(</span><span class="s">&quot;/submit&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">submitEndpoint</span><span class="p">)</span>
<span class="w">        </span><span class="nx">authorized</span><span class="p">.</span><span class="nx">POST</span><span class="p">(</span><span class="s">&quot;/read&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">readEndpoint</span><span class="p">)</span>

<span class="w">        </span><span class="c1">// nested group</span>
<span class="w">        </span><span class="nx">testing</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">authorized</span><span class="p">.</span><span class="nx">Group</span><span class="p">(</span><span class="s">&quot;testing&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="nx">testing</span><span class="p">.</span><span class="nx">GET</span><span class="p">(</span><span class="s">&quot;/analytics&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">analyticsEndpoint</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Listen and serve on 0.0.0.0:8080</span>
<span class="w">    </span><span class="nx">r</span><span class="p">.</span><span class="nx">Run</span><span class="p">(</span><span class="s">&quot;:8080&quot;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="http://localhost:8000/tag/golang.html">Golang</a>
      <a href="http://localhost:8000/tag/go.html">Go</a>
    </p>
  </div>





</article>

    <footer>
<p>
  &copy; 2021 Daniel Dai - <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh" target="_blank">自由转载-非商用-非衍生-保持署名</a>
</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
</p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-nc-nd/3.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
           src="https://i.creativecommons.org/l/by-nc-nd/3.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Daniel Dai的网络日志 ",
  "url" : "http://localhost:8000",
  "image": "http://localhost:8000/daniel_150.jpeg",
  "description": ""
}
</script>

</body>
</html>